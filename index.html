<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>npmvc by rstr74</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">npmvc</h1>
      <h2 class="project-tagline">PureMVC for node.js</h2>
      <a href="https://github.com/rstr74/npmvc" class="btn">View on GitHub</a>
      <a href="https://github.com/rstr74/npmvc/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/rstr74/npmvc/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p><a href="https://travis-ci.org/rstr74/npmvc"><img src="https://travis-ci.org/rstr74/npmvc.svg?branch=develop" alt="Build Status"></a>
<a href="https://www.npmjs.org/package/npmvc"><img src="https://img.shields.io/npm/v/npmvc.svg" alt="npm version badge"></a>
<a href="https://www.npmjs.org/package/npmvc"><img src="http://img.shields.io/npm/dm/npmvc.svg" alt="downloads badge"></a></p>

<h1>
<a id="puremvc-for-nodejs" class="anchor" href="#puremvc-for-nodejs" aria-hidden="true"><span class="octicon octicon-link"></span></a>PureMVC for node.js</h1>

<h3>
<a id="modification-of-the-multicore-javascript-port-for-use-in-a-nodejs-environment" class="anchor" href="#modification-of-the-multicore-javascript-port-for-use-in-a-nodejs-environment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Modification of the <a href="https://github.com/PureMVC/puremvc-js-multicore-framework/wiki">multicore javascript</a> port for use in a node.js environment.</h3>

<p>This is the master repository of the npm <code>npmvc</code> module.</p>

<p>The main goal of this module is to add more flexibility and modulairity within the use of the combination of Node.js and the PureMVC framework. The module enables the aggregation of PureMVC classes in a local file structure or/and in seperated modules.</p>

<p>It adds an <code>include</code> method on top of the official multicore PureMVC JavaScript library (currently version 1.0.1). This method is based on the node.js <code>require</code> method and is added to the puremvc namespace. (See API specs below).</p>

<p>You can use the <code>include</code> function to include dependecies that are located local or in other npm modules. Class files are wrapped the node.js module.export style (see Creating external class files).</p>

<h3>
<a id="current-versions" class="anchor" href="#current-versions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Current versions</h3>

<ul>
<li>1.0.6 (latest)</li>
<li>1.0.6-rc3</li>
<li>1.0.5 (stable)</li>
</ul>

<h3>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>install</h3>

<pre><code>npm install npmvc
</code></pre>

<h2>
<a id="setup-a-puremvc-project-in-nodejs" class="anchor" href="#setup-a-puremvc-project-in-nodejs" aria-hidden="true"><span class="octicon octicon-link"></span></a>setup a puremvc project in node.js</h2>

<p>When installed you can use it like this</p>

<div class="highlight highlight-js"><pre>
<span class="pl-k">var</span> puremvc <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>npmvc<span class="pl-pds">"</span></span>);

puremvc.setSourceDir(<span class="pl-c1">__dirname</span><span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>/src<span class="pl-pds">"</span></span>);
puremvc.include(<span class="pl-s"><span class="pl-pds">"</span>AppConstants<span class="pl-pds">"</span></span>);
puremvc.include(<span class="pl-s"><span class="pl-pds">"</span>ApplicationFacade<span class="pl-pds">"</span></span>);

<span class="pl-c">// make instance of ApplicationFacade and trigger start command</span>
<span class="pl-k">var</span> app <span class="pl-k">=</span> test.ApplicationFacade.getInstance(test.ApplicationFacade.NAME);
app.<span class="pl-c1">start</span>();
</pre></div>

<h2>
<a id="creating-external-class-files" class="anchor" href="#creating-external-class-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating external class files</h2>

<div class="highlight highlight-js"><pre><span class="pl-c1">module</span>.<span class="pl-en">exports</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">include</span>,<span class="pl-smi">puremvc</span>) {

<span class="pl-c">// use include te aquire dependency class files</span>
include(<span class="pl-s"><span class="pl-pds">"</span>controller/StartCommand<span class="pl-pds">"</span></span>);

<span class="pl-c">// ---&gt; now you can use puremvc.define to define class</span>
<span class="pl-c">/**</span>
<span class="pl-c"> * <span class="pl-k">@class</span> test.ApplicationFacade</span>
<span class="pl-c"> * <span class="pl-k">@extends</span> puremvc.Facade</span>
<span class="pl-c"> */</span>
puremvc.define(
    {
        name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>test.ApplicationFacade<span class="pl-pds">'</span></span>,
        parent<span class="pl-k">:</span> puremvc.Facade
    },
    {
        <span class="pl-c">/**</span>
<span class="pl-c">         * <span class="pl-k">@method</span> start</span>
<span class="pl-c">         * <span class="pl-k">@return</span> {[type]} [description]</span>
<span class="pl-c">         */</span>
        <span class="pl-en">start</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {

            <span class="pl-v">this</span>.registerCommand(<span class="pl-s"><span class="pl-pds">"</span>START<span class="pl-pds">"</span></span>, test.controller.StartCommand);
            <span class="pl-v">this</span>.sendNotification(<span class="pl-s"><span class="pl-pds">"</span>START<span class="pl-pds">"</span></span>, {});
        }
    },
    {
        <span class="pl-c">/**</span>
<span class="pl-c">         * Retrieve an instance of ApplicationFacade. </span>
<span class="pl-c">         * If one has not yet been</span>
<span class="pl-c">         * instantiated, one will be created for you.</span>
<span class="pl-c">         *</span>
<span class="pl-c">         * <span class="pl-k">@static</span></span>
<span class="pl-c">         * <span class="pl-k">@param</span> {string} multitonKey</span>
<span class="pl-c">         * <span class="pl-k">@return</span> test.ApplicationFacade</span>
<span class="pl-c">         */</span>
        <span class="pl-en">getInstance</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">multitonKey</span>) {

            <span class="pl-k">var</span> instanceMap <span class="pl-k">=</span> puremvc.Facade.instanceMap;
            instance <span class="pl-k">=</span> instanceMap[multitonKey]; <span class="pl-c">// read from the instance map</span>

            <span class="pl-k">if</span> (instance) <span class="pl-c">// if there is an instance...</span>
                <span class="pl-k">return</span> instance; <span class="pl-c">// return it</span>


            <span class="pl-k">return</span> instanceMap[multitonKey] <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">test.ApplicationFacade</span>(multitonKey);
        },

        <span class="pl-c">/**</span>
<span class="pl-c">         * <span class="pl-k">@static</span></span>
<span class="pl-c">         * <span class="pl-k">@type</span> {string}</span>
<span class="pl-c">         */</span>
        NAME<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>test.ApplicationFacade<span class="pl-pds">'</span></span>
    })
};</pre></div>

<h1>
<a id="extra-methods" class="anchor" href="#extra-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Extra methods:</h1>

<p>This module adds some exra methods on top of the <code>puremvc</code> root object:</p>

<h3>
<a id="puremvcsetsourcedirpathstringvoid" class="anchor" href="#puremvcsetsourcedirpathstringvoid" aria-hidden="true"><span class="octicon octicon-link"></span></a>puremvc.setSourceDir(path:string):void</h3>

<p><strong>path [string]</strong> Sets the source dir for all include's, It uses this for includes on all directory levels. So when you include a dependencie in say <code>model/MyProxy</code> you have to reference <code>model/vo/MyVo</code> by using the path up from the sourceDir, not relative to the folder the file is in: </p>

<pre><code>puremvc.include("model/vo/MyVo");
</code></pre>

<p>If you have to hack this, you can use <strong>tempPath</strong>, the second param of puremvc.include. See below.</p>

<p>Also note that if you do not set the sourceDir it will default to <code>process.cwd()</code> (the directory where you started the main node file).</p>

<hr>

<h3>
<a id="puremvcincludepathstring-temppathstring-callbackfunction" class="anchor" href="#puremvcincludepathstring-temppathstring-callbackfunction" aria-hidden="true"><span class="octicon octicon-link"></span></a>puremvc.include(path:String, tempPath:String, callback:function):*</h3>

<p>Returns any value, but mainly use for return the reference to the classlets constructor from <code>puremvc.define</code>.</p>

<p><strong>path [string]</strong></p>

<p>Path to puremvc class, relative from path set by <code>puremvc.setSourceDir</code></p>

<p><strong>tempPath [String]</strong>
This overides the sourceDir. An include of <code>MyVo</code> in class <code>model/vo/MyVo</code> would look like this:</p>

<pre><code>puremvc.include("vo/MyVo",__dirname);
</code></pre>

<p><strong>callback [function]</strong>
You can use a callback, but you have to trigger it in the aquired class file.</p>

<p>You can <strong>include a class in an other npm module</strong> if the file is not equal in the context of your current sourceDir path. So when you want to load the class <code>SomeClass</code> in the module <code>my-npm-module</code> then do not use tempPath but use:</p>

<pre><code>puremvc.include("my-npm-module/path/to/SomeClass");
</code></pre>

<hr>

<h3>
<a id="puremvcgetsourcedirstring" class="anchor" href="#puremvcgetsourcedirstring" aria-hidden="true"><span class="octicon octicon-link"></span></a>puremvc.getSourceDir():string</h3>

<p>returns the current source directory, root of puremvc classes.</p>

<h1>
<a id="creating-npm-modules" class="anchor" href="#creating-npm-modules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating npm modules</h1>

<p>This is one way to create puremvc modules that harmonize with npm (node package manager).</p>

<p>in package.json add a puremvc object, and provide a namespace, sourcedir (relative from module root dir), and an array with initial includes.
The main property has to point to 'index.js'.</p>

<pre><code>{
  "name": "somemodule",
  "version": "1.0.0",
  "description": "Just a module",
  "main": "index",
  "puremvc":{
    "namespace":"com.domain.somemodule",
    "sourcedir":"./src/",
    "include":[
      "mediator/SomeMediator",
      "model/SomeProxy"
   ]
  },
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "author": "",
  "license": "ISC"
}
</code></pre>

<p>for index.js use this code:</p>

<div class="highlight highlight-js"><pre><span class="pl-c1">module</span>.<span class="pl-en">exports</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">include</span>,<span class="pl-smi">puremvc</span>) {
        puremvc.registerModule(<span class="pl-c1">__dirname</span>);
}</pre></div>

<p>Now in any point in your npmvc application  you can import a module by using the include method:</p>

<div class="highlight highlight-js"><pre><span class="pl-c1">module</span>.<span class="pl-en">exports</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">include</span>,<span class="pl-smi">puremvc</span>) {
       include(<span class="pl-s"><span class="pl-pds">"</span>somemodule<span class="pl-pds">"</span></span>);

        puremvc.define(
        <span class="pl-c">// CLASS INFO</span>
        {
            name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>com.domain.command.RunCommand<span class="pl-pds">'</span></span>,
            parent<span class="pl-k">:</span> puremvc.SimpleCommand
        },
        <span class="pl-c">// INSTANCE MEMBERS</span>
        {
            <span class="pl-en">execute</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
                <span class="pl-en">console</span><span class="pl-c1">.log</span>(puremvc.module(<span class="pl-s"><span class="pl-pds">"</span>somemodule<span class="pl-pds">"</span></span>));
                <span class="pl-k">var</span> mediator <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">com.domain</span>.somemodule.mediator.SomeMediator();
                <span class="pl-v">this</span>.facade.registerMediator(mediator);
            }
        });
}</pre></div>

<h1>
<a id="extra-options" class="anchor" href="#extra-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Extra options:</h1>

<h3>
<a id="puremvcvalidateincludepaths" class="anchor" href="#puremvcvalidateincludepaths" aria-hidden="true"><span class="octicon octicon-link"></span></a>puremvc.validateIncludePaths</h3>

<p><strong>boolean (default:false)</strong></p>

<p>This option only works on macosx darwin. In a case insensitive environment typo's can be hard to find because node.js on a mac does not throw an error when loading case typo's in filenames. When validateIncludePaths is set to true it will warn when a file that is included has a case typo in it's path.</p>

<p>Note that in a other environment than 'darwin', npmvc will ignore this option and outputs a warning about that when set to 'true'.</p>

<p>Set this option before calling the include method.
Example usage:</p>

<pre><code>var puremvc = require("npmvc");
puremvc.validateIncludePaths = true;
</code></pre>

<h3>
<a id="puremvcthrowerrors" class="anchor" href="#puremvcthrowerrors" aria-hidden="true"><span class="octicon octicon-link"></span></a>puremvc.throwErrors</h3>

<p><strong>boolean (default:true)</strong></p>

<p>This option only works on macosx darwin. It suppresses throwing case insensitive errors. It is mainly for testing, so you can ignore it basicly.</p>

<h1>
<a id="the-mit-license" class="anchor" href="#the-mit-license" aria-hidden="true"><span class="octicon octicon-link"></span></a>The MIT License</h1>

<p>Copyright (c) 2015 Robbert Streng</p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/rstr74/npmvc">npmvc</a> is maintained by <a href="https://github.com/rstr74">rstr74</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

